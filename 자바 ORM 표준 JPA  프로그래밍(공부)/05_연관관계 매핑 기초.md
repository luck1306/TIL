# 연관관계 매핑 기초

_자바 객체간의 관계와 DB table간의 관계_

- 자바의 객체는 필드에 관계를 맺을 다른 엔티티 그 자체를 받아 단방향으로만 설정이 가능하다
- 하지만 DB에서는 외래키를 지정하고 JOIN문을 사용하면 관계를 맺은 두  table이 서로를 조회할 수 있다
- 자바에서 두 객체에 서로의 엔티티를 받아 필드로 설정하면 그건 양방향이 아닌 서로 다른 단방향 두 개일 뿐이다.

_코드 예시_
```java
// 단방향의 경우
class A {
	B b;
}

class B{}
```

```java
// 양방향의 경우
class A {
	B b;
}

class B {
	A a;
}
```

__@JoinColumn__

_외래 키를 매핑할 때 사용_

|속성|기능|기본 값|
|-|-|-|
|name|매핑할 외래 키 이름|(이 annotaion을 붙인)필드명 +"\_" + 참조하는 테이블의 기본 키 이름|
|refrencedColumnName|외래 키가 참조하는 대상 테이블의 칼럼명|참조하는 table의 기본 키 칼럼명|
|foriegnKey|외래 키 제약조건을 직접 지정 가능||

__@ManyToOne__

_다대일 관계에서 사용되고, 다중성을 나타냄_

|속성|기능|기본 값|
|-|-|-|
|optional|false로 설정시 연관된 엔티티가 항상 있어야 함|true|
|fetch|글로벌 페치 전략 설정|@ManyToOne : FetchType.EAGER, @OneToMany : FetchType.Lazy|
|cascade|영속성 전이 기능 사용||
|targetEntity|연관된 엔티티의 타입 정보 설정||

__@OneToMany__

_일대다 관계에서 사용되고, 다중성을 나타냄_

|속성|설명|기본 값|
|-|-|-|
|mappedBy|양방향 매핑 시 반대쪽 매핑 필드의 이름||

mappedBy 사용이유
- 앞서 말했듯 자바객체에는 DB의 양방향 관계가 존재하지 않는다.
- 그래서 단방향 두 개로 양방향처럼 보이게 구현한다.
- 하지만 외래키를 관리하는 객체는 있어야한다.
- 외래키를 관리(보유)하는 객체를 __연관관계의 주인__ 이라고 한다.
- 연관관계의 주인은 mappedBy 속성을 사용하지 않는다.
- mappedBy의 값으로 연관관계의 주인(필드)을 지정한다.

외래키의 주인은 외래키를 관리할 수 있지만, 주인이 아닌 반대편은 읽기만 가능하다